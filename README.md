# TwitchMan Autonomous World

A **stream-ready autonomous world** simulation built in Godot 4 with LLM-powered social interactions. Characters perceive, plan, and socially interact in a deterministic, data-driven environment.

## 🎯 Project Goals

- **Autonomous NPCs**: Characters that think, feel, and interact without player input
- **LLM-Powered Dialogue**: Dynamic conversations generated by local LLM via LM Studio
- **Social Simulation**: Complex relationships, moods, and social dynamics
- **Stream-Ready**: Engaging content for streaming with console-based influence
- **Deterministic**: Reproducible simulation for debugging and replay

## 🚀 Features

### Core Systems
- **EventBus**: Central pub/sub system for all world events
- **LLMClient**: LM Studio integration with fallback responses
- **Console Interface**: Real-time command system for streamers
- **Social Simulation**: Mood, relationships, and conversation management

### Console Commands
- `:event <type> [data]` - Trigger world events
- `:conversation <npc1> <npc2> [topic]` - Start conversations between NPCs
- `:topic <topic> [reason]` - Change conversation topics
- `:inject <conversation_id> <topic>` - Inject topics into conversations
- `:merge <group1_id> <group2_id>` - Merge conversation groups
- `:needs <npc_id> <command> [args...]` - Manage NPC social needs
- `:proximity <npc_id> <command> [args...]` - Manage NPC proximity and invitations
- `:move <npc_id> <x> <y>` - Move NPCs around
- `:emote <npc_id> <emotion>` - Make NPCs express emotions
- `:status [detailed]` - Show system health and stats
- `:help [command]` - Display available commands

## 🛠️ Tech Stack

- **Engine**: Godot 4.x
- **Language**: GDScript
- **LLM**: LM Studio (local)
- **Architecture**: Event-driven, component-based
- **Rendering**: 2D top-down (Pokémon-style)

## 📁 Project Structure

```
/
├── autoload/           # Global systems (EventBus, LLMClient)
├── components/         # NPC components (Dialogue, Needs, Proximity)
├── controllers/        # System controllers (Conversation, Topic, Floor)
├── data/              # JSON configurations and templates
├── scenes/            # Main scenes (World, NPC)
├── ui/                # User interface (Console, Dialogue bubbles)
├── debug/             # Debug tools and UIs
└── project.godot      # Godot project configuration
```

## 🚀 Getting Started

### Prerequisites
1. **Godot 4.x** installed
2. **LM Studio** running locally (optional, has fallbacks)

### Installation
1. Clone this repository
2. Open `project.godot` in Godot
3. Run the project

### LM Studio Setup (Optional)
1. Install [LM Studio](https://lmstudio.ai/)
2. Download a model (Mistral, Llama, etc.)
3. Start local server on port 1234
4. The system will automatically detect and use it

## 🎮 Usage

### For Streamers
- **Observe**: Watch autonomous NPCs interact naturally
- **Influence**: Use console commands to guide the world
- **React**: Respond to unexpected social dynamics
- **Engage**: Let viewers suggest commands and events

### Console Examples
```bash
# Start a conversation
:conversation alice bob weather

# Create weather event
:event weather rain intensity=heavy

# Change conversation topic
:topic politics recent_election

# Inject topic into conversation
:inject group_123 local_news

# Merge conversation groups
:merge group_123 group_456

# Move NPC to specific location
:move alice 150 200

# Make NPC express emotion
:emote bob excited

# Check system status
:status detailed

# Manage NPC social needs
:needs alice status
:needs bob set_need 0.8
:needs charlie set_extroversion 0.9

# Manage NPC proximity and invitations
:proximity alice nearby
:proximity bob status
:proximity charlie invite david
```

## 🔧 Development

### Milestones
- **M2.5**: ✅ LLM wiring and fallback (COMPLETED)
- **M2.7**: ✅ Multi-party conversation system (COMPLETED)
- **M2.8**: ✅ Social simulation model and proximity (COMPLETED)
- **M3.0**: ✅ Character status management and basic actions (COMPLETED - Sprint 3)
- **M4.0**: ✅ Action system and planning (COMPLETED - Sprint 4)
- **M4.5**: ⏳ Environmental integration and advanced behaviors

### Current Status
- ✅ Project structure created
- ✅ EventBus autoload implemented
- ✅ LLMClient with fallback responses
- ✅ Console interface with commands
- ✅ Basic World scene and simulation loop
- ✅ Configuration files and templates
- ✅ **Conversation system fully implemented**
- ✅ **ContextPacker for LLM context building**
- ✅ **TopicManager for dynamic topic switching**
- ✅ **FloorManager for turn-taking and interrupts**
- ✅ **ConversationController for group orchestration**
- ✅ **DialogueComponent for NPC dialogue display**
- ✅ **NeedsComponent for social simulation model**
- ✅ **ProximityAgent for proximity-based interactions**
- ✅ **StatusComponent for comprehensive character status management**
- ✅ **ActionPlanner for intelligent action selection**
- ✅ **ActionExecutor for action lifecycle management**

### Next Steps
1. ✅ Implement conversation system components (COMPLETED)
2. Add NPC movement and interaction
3. ✅ Build social simulation model (COMPLETED)
4. Create dialogue bubble UI
5. ✅ Add more console commands (COMPLETED)

## 🎨 Design Principles

- **Deterministic**: Same inputs always produce same outputs
- **Data-Driven**: Configuration through JSON files
- **Modular**: Components can be added/removed easily
- **Performance**: Optimized for streaming (60 FPS target)
- **Fallback**: Graceful degradation when LLM unavailable

## 🤝 Contributing

This is a personal project, but suggestions and feedback are welcome!

## 📝 License

Personal project - not for commercial use.

## 🎯 Roadmap

### Short Term
- [ ] Basic NPC movement and interaction
- [ ] Simple conversation system
- [ ] Mood and relationship tracking

### Medium Term
- [ ] Advanced social dynamics
- [ ] World events and weather
- [ ] Streamer tools and overlays

### Long Term
- [ ] Multiple locations and environments
- [ ] Complex storylines and quests
- [ ] Viewer interaction systems

---

**Built with ❤️ for autonomous storytelling and social simulation**
